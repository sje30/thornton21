---
title: "Mining the Brundy and Thornton (2021) dataset"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
---


# Introduction

[Thornton and Brundy (2021)](https://doi.org/10.7710/2162-3309.2410)
studied the journal prices charged by Elsevier to five different
academic institutions in the USA.  These prices were negotiated and
differed from the [list
prices](https://www.elsevier.com/books-and-journals/journal-pricing/print-price-list)
available on Elsevier's web site.  I think this is a valuable study as
it shows the variance paid for titles by different institutions for
individual titles (as opposed to a "big deal" bundle for all of
ScienceDirect content).

The data underlying their paper are available via
[figshare](https://figshare.com/articles/dataset/2020_Elsevier_Journal_Title_Level_Picing_for_Five_U_S_Research_Universities/13557536).
I have downloaded these files, fixing what I think are a few [minor
issues](https://github.com/sje30/thornton21/blob/master/data/sjenotes.org)
when working with these data in R.  The data were provided separately
for each institution, so here I reassemble them so that they are
arranged into a table, one row per journal, and columns for each
institution.

The key variable is termed *ALP: Adjustment from List Price*.  This is
the percentage difference from list price (negative values meaning a
reduction paid compared to list price).

This interactive document allows you to search by journal, or sort the
data by various columns in the combined dataset.

This interactive document is generated by Rmarkdown, and all source
data are available at <https://github.com/sje30/thornton21>.


```{r init, echo=FALSE, results=FALSE, message=FALSE}
require(tidyverse)
require(readr)
require(dplyr)

read_check_data <- function(file, code) {
  ## Read and check the data works out okay.
  debug <- FALSE
  dat <- read_csv(file)
  dat <- rename(dat, published="Published List Price", final="Final Net Price")

  diffs <- dat$final - dat$published
  error1 <- abs(diffs - dat$Difference)

  if (debug && !all( abs(error1)<=0.011))
    browser()

  alp <- (diffs / dat$published) * 100.0
  alp <- round(alp,1)
  error <- abs( alp - dat$ALP)
  if(debug && !all( error < 0.01))
    browser()
  
  dat %>% add_column(institution=code)
  
}
```
 

```{r read-data, echo=FALSE, results='hide',message=FALSE,warning=FALSE}
f <- read_check_data("data/FS_2020_Pricelist2.csv", "FS")
i <- read_check_data("data/ISU_2020_Pricelist2.csv", "ISU")
i$ALP <- i$ALP * -1 #bug -- see below
c <- read_check_data("data/UNC_2020_Pricelist2.csv", "UNC")
a <- read_check_data("data/IA_2020_Pricelist2.csv", "IA")
v <- read_check_data("data/WVU_2020_Pricelist2.csv", "WVU")
dat <- rbind(f, i, c, a, v)
```

Note there is currently a bug in the data: ALPs for ISU (Iowa) are the
wrong sign.


# Summary of the data set

```{r plot,echo=FALSE,eval=FALSE}
p <- ggplot(dat, aes(x=institution, y=ALP, color=institution)) +
  geom_jitter()
```

Use the mouse to hover over a point to discover the name of the journal
that it represents:

```{r plotly,echo=FALSE,message=FALSE}
library(plotly)
g <- ggplot(dat, aes(x=institution, y=ALP, color=institution, text=Title)) +
  ylab("% adjustment from list price") +
  labs(title="Data: Thornton & Brundy (2021)") +
  geom_jitter()
fig <- ggplotly(g, tooltip="text")
fig
```


<!-- https://datascott.com/blog/subtitles-with-ggplotly/ -->

From this it is clear that UNC (University of North Carolina) and WVU
(West Virginia University) received biggest discounts on list
price. The reason for the increase in some prices for UNC will become
clear when you see which journals they are.  I was suprised to see
that a journal I read (Journal of Theoretical Biology) had the 
biggest saving.

# Reproduction of Table 4 


```{r echo=FALSE}
table4 <- dat %>%
  group_by(institution) %>%
  summarise(total=sum(published),final=sum(final),
            difference=final-total,
            ALP=round(100*difference/total, 1),
            n=n(),
            ACJ=final/n) %>%
  arrange(factor(institution, levels=c("FS", "ISU", "UNC", "IA", "WVU")))

knitr::kable(table4,
             caption="Reproduction of Table 4 from Thornton and Brundy (2021).")
```

This table matches that reported in the paper, except that the final
two columns of the table are excluded (e.g. 1833 titles available in
ScienceDirect).  In three of five cases, the institution saved money
compared to the list price.  In this table, ACJ is the Average Cost of
a Journal (total paid divided by number of journals).

# Journals with  high ALP

e.g. find those greater than 30% than list price.  No surprises that
the outlier (384% ALP) is the journal *Cell*.  In the following tables
you can search for particular journal names, or clicking on the arrows
next to each column heading will sort by that column.

```{r high-alp}
DT::datatable(filter(dat, ALP>=30))
```


#  Journals with low ALP

e.g. find those with at least 30% saving on list price.  
```{r low-alp}
DT::datatable(filter(dat, ALP<=-30))
```


<!-- ## Raw database of files. -->

<!-- Here you can search for individual journals, or sort them by ranking the -->
<!-- different columns. -->

<!-- e.g. by searching for "Trends in Genetics" you can see the variance in -->
<!-- price paid by 3 institutions. -->

<!-- ```{r data} -->
<!-- DT::datatable(dat) -->
<!-- ``` -->

# Variance of prices

```{r counts, echo=FALSE,message=FALSE}
f1 = f %>% select(Title, published,  FS=ALP)
i1 = i %>% select(Title, published, ISU=ALP)
c1 = c %>% select(Title, published, UNC=ALP)
a1 = a %>% select(Title, published,  IA=ALP)
v1 = v %>% select(Title, published, WVU=ALP)
dat1 <- full_join(f1, i1) %>% full_join(c1) %>% full_join(a1) %>% full_join(v1)
dat2 <- dat1 %>% select(FS, ISU, UNC, IA, WVU) %>% mutate(count=rowSums(!is.na(.)))
dat1$count <- dat2$count
```

Most journals are subscribed to by only one institution:

```{r table-of-counts,echo=FALSE}
table(dat1$count)
```

This table shows for each journal in the database the price paid by
each institution.  The column 'count' indicates the number of institutions
that subscribed to that journal, and varies between 1 and 5.  

```{r journal-variance}
DT::datatable(dat1)
```


# Acknowledgments

Thanks to Joel Thornton and Curtis Brundy for providing the data, and
to Ross Mounce for comments. 

